---
import type { Event } from '@/types/events';
import { formatEventDate, formatPrice, getRulesEnforcementLabel, formatDistance } from '@/utils/formatters';

interface Props {
  event: Event;
}

const { event } = Astro.props;
---

<div class="card p-6 hover:scale-[1.02] transition-transform duration-200">
  <!-- Event Title -->
  <h2 class="text-2xl font-bold text-white mb-2">{event.title}</h2>
  
  <!-- Organization -->
  <div class="text-mtg-gold font-semibold mb-4">{event.organization.name}</div>
  
  <!-- Date and Time -->
  <div class="flex items-center text-gray-300 mb-3">
    <svg class="w-5 h-5 mr-2 text-mtg-gold" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
    </svg>
    <span>{formatEventDate(event.scheduledStartTime)}</span>
  </div>
  
  <!-- Location -->
  <div class="flex items-start text-gray-300 mb-3">
    <svg class="w-5 h-5 mr-2 text-mtg-gold mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
    </svg>
    <div>
      <div>{event.organization.postalAddress}</div>
      <div class="text-sm text-gray-400">{formatDistance(event.distance)} from Hamburg</div>
    </div>
  </div>
  
  <!-- Description -->
  {event.description && (
    <div class="text-gray-300 mb-4 line-clamp-3">
      <p class="whitespace-pre-line">{event.description}</p>
    </div>
  )}
  
  <!-- Event Details Grid -->
  <div class="grid grid-cols-2 gap-4 mt-4 pt-4 border-t border-gray-700">
    <!-- Price -->
    <div>
      <div class="text-gray-400 text-sm">Entry Fee</div>
      <div class="text-white font-semibold">{formatPrice(event.entryFee.amount, event.entryFee.currency)}</div>
    </div>
    
    <!-- Capacity -->
    <div>
      <div class="text-gray-400 text-sm">Capacity</div>
      <div class="text-white font-semibold">{event.capacity ? `${event.capacity} Players` : 'Unlimited'}</div>
    </div>
    
    <!-- Rules Enforcement -->
    <div>
      <div class="text-gray-400 text-sm">Rules Level</div>
      <div class="text-white font-semibold">{getRulesEnforcementLabel(event.rulesEnforcementLevel)}</div>
    </div>
    
    <!-- Format -->
    <div>
      <div class="text-gray-400 text-sm">Format</div>
      <div class="text-white font-semibold">{event.pairingType}</div>
    </div>
  </div>
  
  <!-- Website Link -->
  {event.organization.website && (
    <div class="mt-4">
      <a 
        href={event.organization.website.startsWith('http') ? event.organization.website : `https://${event.organization.website}`}
        target="_blank"
        rel="noopener noreferrer"
        class="inline-flex items-center text-mtg-gold hover:text-mtg-gold-400 font-medium transition-colors"
      >
        Visit Website
        <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
        </svg>
      </a>
    </div>
  )}
</div>
